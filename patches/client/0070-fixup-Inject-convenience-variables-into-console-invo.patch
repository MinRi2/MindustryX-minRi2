From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: way-zer <himc.wicp@gmail.com>
Date: Fri, 7 Feb 2025 15:38:00 +0800
Subject: [PATCH] fixup! Inject convenience variables into console invocations

---
 core/src/mindustry/mod/Scripts.java                  | 2 +-
 core/src/mindustry/ui/fragments/ConsoleFragment.java | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/core/src/mindustry/mod/Scripts.java b/core/src/mindustry/mod/Scripts.java
index 97527093d2d4c1ecee86b6a3fc4955b49f235535..64eab0d4fe1cb9f3f1718b6f2f358009417b31af 100644
--- a/core/src/mindustry/mod/Scripts.java
+++ b/core/src/mindustry/mod/Scripts.java
@@ -55,7 +55,7 @@ public class Scripts implements Disposable{
 
     public String runConsole(String text){
         try{
-            Object o = context.evaluateString(scope, injectConsoleVariables() + text, "console.js", 1);
+            Object o = context.evaluateString(scope, text, "console.js", 1);
             if(o instanceof NativeJavaObject n) o = n.unwrap();
             if(o == null) o = "null";
 
diff --git a/core/src/mindustry/ui/fragments/ConsoleFragment.java b/core/src/mindustry/ui/fragments/ConsoleFragment.java
index 013255ce5aa828d538814fa25dc64c6a56bf9136..469919ac8dcfc19e181a8f2993fcc65e3e4128b0 100644
--- a/core/src/mindustry/ui/fragments/ConsoleFragment.java
+++ b/core/src/mindustry/ui/fragments/ConsoleFragment.java
@@ -176,7 +176,7 @@ public class ConsoleFragment extends Table{
         history.insert(1, message);
 
         addMessage("[lightgray]> " + message.replace("[", "[["));
-        addMessage(mods.getScripts().runConsole(message).replace("[", "[["));
+        addMessage(mods.getScripts().runConsole(mods.getScripts().injectConsoleVariables() + message).replace("[", "[["));
     }
 
     public void toggle(){
