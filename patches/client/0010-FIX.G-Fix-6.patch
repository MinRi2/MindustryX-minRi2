From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: way-zer <himc.wicp@gmail.com>
Date: Mon, 26 Dec 2022 15:29:10 +0800
Subject: [PATCH] FIX.G: Fix #6

---
 .../src/mindustry/world/blocks/payloads/PayloadConveyor.java | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/core/src/mindustry/world/blocks/payloads/PayloadConveyor.java b/core/src/mindustry/world/blocks/payloads/PayloadConveyor.java
index fb54c1721acc34a340292f6b9f1621de824bee5a..a108ac56eb6eb780e7882bad477c8d7f29eb6647 100644
--- a/core/src/mindustry/world/blocks/payloads/PayloadConveyor.java
+++ b/core/src/mindustry/world/blocks/payloads/PayloadConveyor.java
@@ -157,7 +157,10 @@ public class PayloadConveyor extends Block{
                 if(valid && stepAccepted != curStep && item != null){
                     if(next != null){
                         //trigger update forward
-                        next.updateTile();
+                        //MDTX: fix NPE bug, copy from PayloadRouter.PayloadRouterBuild.pickNext
+                        if(next instanceof PayloadConveyorBuild){
+                            next.updateTile();//Update for progress??
+                        }
 
                         //TODO add self to queue of next conveyor, then check if this conveyor was selected next frame - selection happens deterministically
                         if(next != null && next.acceptPayload(this, item)){
